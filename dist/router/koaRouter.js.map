{"version":3,"sources":["../../router/koaRouter.js"],"names":["fs","require","Router","httpHandle","koaBody","render","page","Promise","resolve","reject","viewUrl","readFile","err","data","api","get","post","put","ctx","console","log","del","common","body","router","use","routes","allowedMethods","module","exports"],"mappings":";;;;AAAA;;;AAGA,IAAMA,KAAKC,QAAQ,IAAR,CAAX;AACA,IAAMC,SAASD,QAAQ,YAAR,CAAf;;eACmBA,QAAQ,8BAAR,C;IAAZE,U,YAAAA,U;;AACP,IAAMC,UAAUH,QAAQ,UAAR,GAAhB;;AAEA,IAAMI,SAAS,SAATA,MAAS,CAACC,IAAD,EAAU;AACrB,WAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACpC,YAAIC,sBAAoBJ,IAAxB;AACAN,WAAGW,QAAH,CAAYD,OAAZ,EAAqB,QAArB,EAA+B,UAACE,GAAD,EAAMC,IAAN,EAAe;AAC1C,gBAAID,GAAJ,EAAS;AACLH,uBAAOG,GAAP;AACH,aAFD,MAEO;AACHJ,wBAAQK,IAAR;AACH;AACJ,SAND;AAOH,KATM,CAAP;AAUH,CAXD;;AAaA,IAAIC,MAAM,IAAIZ,MAAJ,EAAV;;AAEAY,IAAIC,GAAJ,CAAQ,GAAR,EAAaZ,UAAb,EACKa,IADL,CACU,GADV,EACcZ,OADd,EACsBD,UADtB,EAEKc,GAFL,CAES,GAFT;AAAA,uEAEc,iBAAMC,GAAN;AAAA;AAAA;AAAA;AAAA;AACVC,gCAAQC,GAAR,CAAY,CAAZ;;AADU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAFd;;AAAA;AAAA;AAAA;AAAA,KAIGC,GAJH,CAIO,GAJP;AAAA,wEAIY,kBAAMH,GAAN;AAAA;AAAA;AAAA;AAAA;AACRC,gCAAQC,GAAR,CAAY,CAAZ;;AADQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAJZ;;AAAA;AAAA;AAAA;AAAA;;AAQA,IAAIE,SAAS,IAAIpB,MAAJ,EAAb;AACAoB,OAAOP,GAAP,CAAW,GAAX;AAAA,wEAAgB,kBAAMG,GAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BACKb,OAAO,YAAP,CADL;;AAAA;AACZa,4BAAIK,IADQ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAhB;;AAAA;AAAA;AAAA;AAAA;;AAIA,IAAIC,SAAS,IAAItB,MAAJ,EAAb;AACAsB,OAAOC,GAAP,CAAW,MAAX,EAAmBX,IAAIY,MAAJ,EAAnB,EAAiCZ,IAAIa,cAAJ,EAAjC;AACAH,OAAOC,GAAP,CAAW,GAAX,EAAgBH,OAAOI,MAAP,EAAhB,EAAiCJ,OAAOK,cAAP,EAAjC;;AAGAC,OAAOC,OAAP,GAAiBL,MAAjB","file":"koaRouter.js","sourcesContent":["/**\r\n * Created by AllenFeng on 2017/8/29.\r\n */\r\nconst fs = require('fs')\r\nconst Router = require('koa-router');\r\nconst {httpHandle}=require('../Infrastructure/httpHandle');\r\nconst koaBody = require('koa-body')();\r\n\r\nconst render = (page) => {\r\n    return new Promise((resolve, reject) => {\r\n        let viewUrl = `./view/${page}`\r\n        fs.readFile(viewUrl, \"binary\", (err, data) => {\r\n            if (err) {\r\n                reject(err)\r\n            } else {\r\n                resolve(data)\r\n            }\r\n        })\r\n    })\r\n}\r\n\r\nlet api = new Router();\r\n\r\napi.get('*', httpHandle)\r\n    .post('*',koaBody,httpHandle)\r\n    .put('*', async(ctx) => {\r\n    console.log(3)\r\n}).del('*', async(ctx) => {\r\n    console.log(4);\r\n});\r\n\r\nlet common = new Router();\r\ncommon.get('*', async(ctx) => {\r\n    ctx.body = await render('index.html');\r\n})\r\n\r\nlet router = new Router();\r\nrouter.use('/app', api.routes(), api.allowedMethods());\r\nrouter.use('/', common.routes(), common.allowedMethods());\r\n\r\n\r\nmodule.exports = router;\r\n\r\n\r\n\r\n"]}